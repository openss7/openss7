'\" rt
.\" -*- nroff -*- vim: ft=nroff noautoindent nocindent nosmartindent
.\"
.\" @(#) $Id: T_CONN_RES.7.man,v 0.9.2.2 2004/05/12 10:15:02 brian Exp $
.\"
.\" =========================================================================
.\"
.\" Copyright (C) 2001-2004  OpenSS7 Corporation <www.openss7.com>
.\"
.\" All Rights Reserved.
.\"
.\" Permission is granted to make and distribute verbatim copies of this
.\" manual provided the copyright notice and this permission notice are
.\" preserved on all copies.
.\"
.\" Permission is granted to copy and distribute modified versions of this
.\" manual under the conditions for verbatim copying, provided that the
.\" entire resulting derived work is distributed under the terms of a
.\" permission notice identical to this one
.\" 
.\" Since the Linux kernel and libraries are constantly changing, this
.\" manual page may be incorrect or out-of-date.  The author(s) assume no
.\" responsibility for errors or omissions, or for damages resulting from
.\" the use of the information contained herein.  The author(s) may not
.\" have taken the same level of care in the production of this manual,
.\" which is licensed free of charge, as they might when working
.\" professionally.
.\" 
.\" Formatted or processed versions of this manual, if unaccompanied by
.\" the source, must acknowledge the copyright and authors of this work.
.\"
.\" =========================================================================
.\"
.\" Modified $Date: 2004/05/12 10:15:02 $ by $Author: brian $
.\"
.\" =========================================================================
.so openss7.macros
.R1
bracket-label "\fR[\fB" "\fR]" "\fR, \fB"
no-default-database
database openss7.refs
accumulate
move-punctuation
abbreviate A
join-authors ", " ", " " and "
et-al " et al" 2 3
abbreviate-label-ranges ".."
sort-adjacent-labels
.R2
.\"
.\"
.TH T_CONN_RES 7 "$Date: 2004/05/12 10:15:02 $" "$Name:  $" "Transport Provider Interface (TPI)"
.SH NAME
.B T_CONN_RES
\- Connection Response
.SH SYNOPSIS
This message consists of one
.B M_PROTO
message block followed by zero or more
.B M_DATA
blocks if any user data is specified by the transport user.
The format of the
.B M_PROTO
message block is as follows:
.sp
.nf
\fC\s-1\
struct T_conn_res {
    t_scalar_t   PRIM_type;     /* always T_CONN_RES     */
    t_uscalar_t  ACCEPTOR_id;   /* accepting endpoint ID */
    t_scalar_t   OPT_length;    /* options length        */
    t_scalar_t   OPT_offset;    /* options offset        */
    t_scalar_t   SEQ_number;    /* sequence number       */
};
\fR\s+1
.fi
.SH DESCRIPTION
This primitive issent by a transport user to the transport provider
on a listening transport endpoint (hereafter, for brevity, referred to as the
listener) on which the transport user received a
.BR T_CONN_IND .
This primitive
requests that the transport provider should accept the connection indication
identified by SEQ_number on the response transport endpoint specified by
.IR ACCEPTOR_id .
.SH PARAMETERS
.TP 16
.I PRIM_type
identifies the primitive type.
.TP
.I ACCEPTOR_id
identifies the transport provider endpoint which should be used to accept
the connect request.  The mapping of the contents of
.I ACCEPTOR_id
to the
internal reference to a transport endpoint (often a pointer to a streams
queue) is transport-provider defined.
.TP
.I OPT_length
is the length of the responding options.
.TP
.I OPT_offset
is the offset from the beginning of the
.B M_PROTO
message block where the
responding options begin. 
.TP
.I SEQ_number
is the sequence number which identifies the connection being responded to.
.PP
The proper alignment of the options in the
.B M_PROTO
message block is not
guaranteed.  The options in the
.B M_PROTO
message block are, however,
aligned the same as they were received from the transport user. 
.SH RULES
The following rules apply when the transport endpoint referenced by
.I ACCEPTOR_id
is not the same as the listener:
.IP - 4
If the endpoint referenced by
.I ACCEPTOR_id
is not bound at the time that the
.B T_CONN_RES
primitive is received by the transport provider, the
transport provider will automatically bind that endpoint to the same
protocol address as that to which the listener is bound.
.IP -
If the endpoint referenced by
.I ACCEPTOR_id
is already bound when the
.B T_CONN_RES
primitive was received by the transport provider, it must be
bound to a protocol address with a
.I CONIND_number
of zero and must be in the
.B TS_IDLE
state.
.PP
In all cases, this primitive requires the transport provider to generate
one of the following acknowledgments on receipt of the primitive, and the
transport user wait for the acknowledgment before issuing any other
primitives:
.SS Successful
Correct acknowledgment of the primitive is indicated via the
.BR T_OK_ACK (7)
primitive described in reference TPI-SMD. 
.SS Non-fatal errors
These errors will be indicated via the
.BR T_ERROR_ACK (7)
primitive described in
reference TPI-SMD.
.SH ERRORS
The allowable errors are as follows:
.TP 16
.RB [ TACCES ]
This indicates that the user did not have proper permissions for the use of
the options or response id.
.TP
.RB [ TBADADDR ]
The specified protocol address (the one bound to the endpoint referenced by
.IR ACCEPTOR_id )
was in an incorrect format or contained illegal information.
.TP
.RB [ TBADDATA ]
The amount of user data specified was invalid.
.TP
.RB [ TBADF ]
This indicates that the response acceptor identifier was invalid.
.TP
.RB [ TBADOPT ]
This indicates that the options were in an incorrect format, or they contained
invalid information.
.TP
.RB [ TBADSEQ ]
The sequence number specified in the primitive was incorrect or invalid.
.TP
.RB [ TNOTSUPPORT ]
This primitive is not supported by the transport provider.
.TP
.RB [ TOUTSTATE ]
The primitive would place the transport interface out of state.
.TP
.RB [ TPROVMISMATCH ]
This indicates that the response
.I ACCEPTOR_id
does not identify a transport
provider of the same type as the listener.
.TP
.RB [ TRESADDR ]
The transport provider requires both transport endpoints (that is, the one
referenced by
.I ACCEPTOR_id
and the listener) to be bound to the same address.
.TP
.RB [ TRESQLEN ]
The endpoint referenced by
.I ACCEPTOR_id
was different from the listener,
but was bound to a protocol address with a
.I CONIND_number
that is
greater than zero.
.TP
.RB [ TSYSERR ]
A system error has occurred and the Linux system error is indicated in
the primitive.
.SH MODES
Only connection-mode.
.SH ORIGINATOR
Transport user.
.SH "SEE ALSO"
.BR T_CONN_IND (7),
.BR T_DISCON_IND (7).
.SH HISTORY
.PP
The Transport Provider Interface first appeared in SVR 4.
.[
svr4
.]
.SH CONFORMANCE
.PP
This interface conforms to TPI Version 2, Draft 2.
.[
TPI Revision 2.0.0
.]
.XX
.[
magic
.]
.[
advprog
.]
.[
$LIST$
.]
.T2
