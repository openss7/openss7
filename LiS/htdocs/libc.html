<html>



<head>

<title>LiS Library Routines (libc)</title>
<meta name="title" content="LiS Library Routines (libc)">
<meta name="keywords" content="Linux, streams, library routines, libc, LiS">
<meta name="description" content="LiS libc routines">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

<style type="text/css">

<!--

h2 {  font-family: Arial, Helvetica, sans-serif}

h1 {  font-family: Arial, Helvetica, sans-serif}

h3 {  font-family: Arial, Helvetica, sans-serif}

p {  font-family: Arial, Helvetica, sans-serif; font-size: 12pt}

a {  font-family: Arial, Helvetica, sans-serif; color: #0000FF}

a:link {  font-family: Arial, Helvetica, sans-serif; color: #0000FF}

a:hover {  font-family: Arial, Helvetica, sans-serif; color: #FF3333}

li {  font-family: Arial, Helvetica, sans-serif; font-size: 10pt}

ol {  font-family: Arial, Helvetica, sans-serif; font-size: 10pt}

-->

</style>

<script language="JavaScript">

<!--

function MM_swapImgRestore() { //v3.0

  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++) x.src=x.oSrc;

}



function MM_preloadImages() { //v3.0

  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();

    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)

    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}

}



function MM_findObj(n, d) { //v3.0

  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {

    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}

  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];

  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document); return x;

}



function MM_swapImage() { //v3.0

  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array; for(i=0;i<(a.length-2);i+=3)

   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc) x.oSrc=x.src; x.src=a[i+2];}

}

//-->

</script>

</head>







<body bgcolor="#FFFFFF" onLoad="MM_preloadImages('i/kernel_on.gif','i/download_on.gif','i/install_on.gif','i/removal_on.gif','i/loading_on.gif','i/drivers_on.gif','i/config_on.gif','i/demand_on.gif','i/compiled_on.gif','i/apps_on.gif','i/otherres_on.gif','i/command_on.gif','i/dki_on.gif','i/libs_on.gif','i/lisdrvrs_on.gif')">
<table width="700" border="0" cellspacing="0" cellpadding="0" height="120" bgcolor="#6666CC">

	 <tr> 

		  <td width="120" height="120" rowspan="3"><a href="index.html"><img src="i/penguin.gif" width="120" height="120" border="0"></a></td>

		  
    <td rowspan="3" width="570" height="120" align="center" valign="middle"> 
      <h1><font color="#FFFFFF" style="font-size:30pt;">Linux STREAMS (LiS)</font></h1>

			 </td>

		  <td bgcolor="#ffffff" rowspan="3" width="10" height="120"><img src="./i/sideborder.gif" width="10" height="130"></td>

	 </tr>

	 <tr> </tr>

	 <tr> </tr>

</table>

<img src="./i/bottomborder.gif" width="703" height="15"><br>

<table width="700" border="0" cellspacing="0" cellpadding="0">

  <tr> 

    <td rowspan="2" width="100" align="left" valign="top"> 
      <table width="90" border="0" cellspacing="0" cellpadding="0">
        <tr> 
          <td><a href="kernel.html" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('kernel','','i/kernel_on.gif',1)"><img name="kernel" border="0" src="i/kernel_off.gif" width="81" height="35"></a></td>
        </tr>
        <tr> 
          <td><a href="download.html" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('download','','i/download_on.gif',1)"><img name="download" border="0" src="i/download_off.gif" width="81" height="35"></a></td>
        </tr>
        <tr> 
          <td><a href="install.html" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('install','','i/install_on.gif',1)"><img name="install" border="0" src="i/install_off.gif" width="81" height="35"></a></td>
        </tr>
        <tr> 
          <td><a href="removal.html" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('removal','','i/removal_on.gif',1)"><img name="removal" border="0" src="i/removal_off.gif" width="81" height="35"></a></td>
        </tr>
        <tr> 
          <td><a href="loading.html" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('loading','','i/loading_on.gif',1)"><img name="loading" border="0" src="i/loading_off.gif" width="81" height="35"></a></td>
        </tr>
        <tr> 
          <td><a href="drivers.html" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('drivers','','i/drivers_on.gif',1)"><img name="drivers" border="0" src="i/drivers_off.gif" width="81" height="35"></a></td>
        </tr>
        <tr> 
          <td><a href="config.html" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('config','','i/config_on.gif',1)"><img name="config" border="0" src="i/config_off.gif" width="81" height="35"></a></td>
        </tr>
        <tr> 
          <td><a href="demand.html" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('demand','','i/demand_on.gif',1)"><img name="demand" border="0" src="i/demand_off.gif" width="81" height="35"></a></td>
        </tr>
        <tr> 
          <td><a href="compiled.html" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('compiled','','i/compiled_on.gif',1)"><img name="compiled" border="0" src="i/compiled_off.gif" width="81" height="35"></a></td>
        </tr>
        <tr> 
          <td><a href="apps.html" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('apps','','i/apps_on.gif',1)"><img name="apps" border="0" src="i/apps_off.gif" width="81" height="35"></a></td>
        </tr>
        <tr> 
          <td><a href="otherres.html" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('otherres','','i/otherres_on.gif',1)"><img name="otherres" border="0" src="i/otherres_off.gif" width="81" height="35"></a></td>
        </tr>
        <tr> 
          <td><a href="cmds.html" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('cmds','','i/command_on.gif',1)"><img name="cmds" border="0" src="i/command_off.gif" width="81" height="35"></a></td>
        </tr>
        <tr> 
          <td><a href="dki.html" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('dki','','i/dki_on.gif',1)"><img name="dki" border="0" src="i/dki_off.gif" width="81" height="35"></a></td>
        </tr>
        <tr> 
          <td><a href="libc.html" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('libs','','i/libs_on.gif',1)"><img name="libs" border="0" src="i/libs_off.gif" width="81" height="35"></a></td>
        </tr>
        <tr> 
          <td><a href="drvrs.html" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('lisdrvrs','','i/lisdrvrs_on.gif',1)"><img name="lisdrvrs" border="0" src="i/lisdrvrs_off.gif" width="81" height="35"></a></td>
        </tr>
      </table>
    </td>

    <td width="600" height="75"> 

      <div align="center"> 
        <h2>LiS Library Routines (libc)</h2>

      </div>

    </td>

  </tr>

  <tr> 

    <td width="600" height="100%" align="left" valign="top"> 
      <h2> <a name="Contents"></a>Contents</h2>
      <a href="#Introduction">Introduction</a> 
      <p><a href="#LiS Library Routines">LiS Library Routines</a> 
      <p><a href="#Using the LiS Library">Using the LiS Library</a> <br>
        &nbsp; 
      <p> 
      <hr width="100%">
      <h2> <a name="Introduction"></a>Introduction</h2>
      <p>During the installation process of Linux STREAMS (LiS) a subroutine library 
        is built and installed on your system.&nbsp; Three versions of the library 
        are built and installed.&nbsp; They are as follows. <br>
        &nbsp; </p>
      <table cols=2 width="100%" NOSAVE >
        <tr NOSAVE> 
          <td width="20%" NOSAVE> 
            <p><b>Library</b></p>
          </td>
          <td> 
            <p><b>Description</b></p>
          </td>
        </tr>
        <tr NOSAVE> 
          <td NOSAVE> 
            <p><font face="Courier New, Courier, mono">libLiS.a</font></p>
          </td>
          <td> 
            <p>Interface routines to LiS in static library form.</p>
          </td>
        </tr>
        <tr> 
          <td> 
            <p><font face="Courier New, Courier, mono">libLiS.so</font></p>
          </td>
          <td> 
            <p>Interface routines to LiS in dynamic library form.</p>
          </td>
        </tr>
        <tr> 
          <td> 
            <p><font face="Courier New, Courier, mono">libpLiS.so</font></p>
          </td>
          <td> 
            <p>Like libLiS.so but omits the "<font face="Courier New, Courier, mono">pipe</font>" 
              system call.</p>
          </td>
        </tr>
      </table>
      <p>These three libraries are copied to the directory <font face="Courier New, Courier, mono">/usr/lib</font> 
        when LiS is installed. 
      <p>In addition, the utility program <font face="Courier New, Courier, mono">ldconfig</font> 
        is run during the LiS <font face="Courier New, Courier, mono">make install</font>.&nbsp; 
        This causes this library to be linked, or searched, ahead of the standard 
        C library.&nbsp; This is necessary because the standard C library contains 
        dummy routines for the STREAMS interface functions, or most of them in 
        the best case.&nbsp; If these dummy routines preempt the LiS versions 
        then STREAMS applications will always perceive error returns from such 
        routines as <font face="Courier New, Courier, mono">getmsg</font> and 
        <font face="Courier New, Courier, mono">putmsg</font>. 
      <p><a href="#Contents">Back to Contents</a> 
      <p> 
      <hr width="100%">
      <h2> <a name="LiS Library Routines"></a>LiS Library Routines</h2>
      <p><br>
        The following routines are present in the libraries <font face="Courier New, Courier, mono">libLiS.a</font> 
        and <font face="Courier New, Courier, mono">libLiS.so</font>.&nbsp; The 
        library <font face="Courier New, Courier, mono">libpLiS.so</font> omits 
        the "<font face="Courier New, Courier, mono">pipe</font>" routine. 
      <p>The routines in these libraries are standard STREAMS interface routines.&nbsp; 
        As such we do not offer detailed descriptions of the functions of these 
        routines.&nbsp; Instead we refer the reader to the <a href="otherres.html">AT&amp;T 
        SVR4 STREAMS documentation</a>. 
      <pre><tt>int&nbsp;&nbsp;&nbsp;&nbsp; fattach(int fd, const char *path)</tt>          
<tt>int&nbsp;&nbsp;&nbsp;&nbsp; fdetach(const char *path)</tt> 
<tt>int&nbsp;&nbsp;&nbsp;&nbsp; getmsg(int fd, void *ctlptr, void *dataptr, int *flagsp)</tt> 
<tt>int&nbsp;&nbsp;&nbsp;&nbsp; getpmsg(int fd, void *ctlptr, void *dataptr, int *bandp, int *flagsp)</tt> 
<tt>int&nbsp;&nbsp;&nbsp;&nbsp; isastream(int fd)</tt> 
<tt>int&nbsp;&nbsp;&nbsp;&nbsp; pipe(int *fd)</tt> 
<tt>int&nbsp;&nbsp;&nbsp;&nbsp; poll(void *pollfds, long nfds, int timeout)</tt>          
<tt>int&nbsp;&nbsp;&nbsp;&nbsp; putmsg(int fd, void *ctlptr, void *dataptr, int flags)</tt> 
<tt>int&nbsp;&nbsp;&nbsp;&nbsp; putpmsg(int fd, void *ctlptr, void *dataptr, int *bandp, int *flagsp)</tt><tt></tt>        </pre>
      <p>These routines are all very small pieces of code.&nbsp; Most of them 
        simply pass their parameters to LiS via a system call.&nbsp; The fattach 
        and fdetach routines use ioctls to LiS if there is no system call available 
        to call directly. 
      <p>The <font face="Courier New, Courier, mono">poll</font> routine simply 
        executes the <font face="Courier New, Courier, mono">poll</font> system 
        call.&nbsp; It is present for backward compatibility to 2.0 kernels, in 
        which LiS provided the <font face="Courier New, Courier, mono">poll</font> 
        system call. 
      <p>The <font face="Courier New, Courier, mono">pipe</font> routine has the 
        same semantics as the standard C library routine.&nbsp; It uses STREAMS 
        FIFOs to implement the pipe instead of the standard Linux pipes. 
      <p>The <font face="Courier New, Courier, mono">libpLiS.so</font> library, 
        the one that preempts the standard C library, omits the STREAMS <font face="Courier New, Courier, mono">pipe</font> 
        routine so that standard Linux pipes are used unless the user explicitly 
        links in <font face="Courier New, Courier, mono">libLiS</font>. 
      <p><a href="#Contents">Back to Contents</a> 
      <p> 
      <hr width="100%">
      <h2> <a name="Using the LiS Library"></a>Using the LiS Library</h2>
      <p>In order to use one of the LiS libraries you should include the file 
        <font face="Courier New, Courier, mono">&lt;sys/stropts.h></font> in you 
        program source code.&nbsp; On you compiler command line you can add the 
        option "<font face="Courier New, Courier, mono">-I/usr/src/LiS/include</font>" 
        to include the version of <font face="Courier New, Courier, mono">stropts.h</font> 
        that is distributed with LiS, or omit the option to include the system 
        standard header file.&nbsp; The two header files are believed to be compatible 
        enough that it does not matter which one you include in your program. 
      </p>
      <p>When linking your program, or performing a final "cc" to build your executable, 
        include one of the following options on your command line. <br>
        &nbsp; 
      <table cols=2 width="100%" NOSAVE >
        <tr NOSAVE> 
          <td width="38%" NOSAVE><font face="Courier New, Courier, mono">/usr/lib/libLiS.a</font></td>
          <td width="62%">Use <font face="Courier New, Courier, mono">libLiS.a</font> 
            (static, includes "<font face="Courier New, Courier, mono">pipe</font>")</td>
        </tr>
        <tr> 
          <td width="38%"><font face="Courier New, Courier, mono">-lLiS</font></td>
          <td width="62%">Use <font face="Courier New, Courier, mono">libLiS.so</font> 
            (dynamic, includes "<font face="Courier New, Courier, mono">pipe</font>")</td>
        </tr>
        <tr> 
          <td width="38%"><font face="Courier New, Courier, mono">-lpLiS</font></td>
          <td width="62%">Use <font face="Courier New, Courier, mono">libpLiS.so</font> 
            (dynamic, omits "<font face="Courier New, Courier, mono">pipe</font>")</td>
        </tr>
        <tr> 
          <td width="38%" valign="top">Omit any options</td>
          <td width="62%" valign="top">As of libc-2.2.1 the LiS STREAMS interface 
            routines will be used automatically via <font face="Courier New, Courier, mono">libpLiS.so</font>.</td>
        </tr>
      </table>
      <p><a href="#Contents">Back to Contents</a> 
      <p> 
      <hr width="100%">
      <p>&nbsp; </p>

      </td>

  </tr>

</table>

<p align="left">&nbsp;</p>



</body>



</html>



